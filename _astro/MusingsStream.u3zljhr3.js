import{o as Te,e as Oe,i as He,d as N,s as De,f as Ke}from"./router.25gVyca-.js";import{S as Fe,T as Le,U as Ue,V as Ie,W as Ve,h as we,X as qe,Y as Re,Z as $e,_ as Ce,$ as We,a0 as Ge,y as Je,D as V,Q as Xe,I,B as Ze,E as H,J as ae,F as n,N as se,O as G,M as B,G as ve,L as Ae,K as xe,a1 as _e,a2 as ce}from"./template.C-gyten8.js";import{s as be}from"./render.BiRa2QwQ.js";import{e as Be,s as Qe,h as ze,a as Ne}from"./ContentPane.CbXmcqhk.js";import Ye from"./index.Blr6EMNg.js";import{g as et,H as Se}from"./index.24N2qqXS.js";function Ee(o,m,L){Fe(()=>{var q=Le(()=>m(o,L?.())||{});if(L&&q?.update){var y=!1,j={};Ue(()=>{var R=L();Ie(R),y&&Ve(j,R)&&(j=R,q.update(R))}),y=!0}if(q?.destroy)return()=>q.destroy()})}const tt=Symbol("is custom element"),rt=Symbol("is html");function nt(o){if(we){var m=!1,L=()=>{if(!m){if(m=!0,o.hasAttribute("value")){var q=o.value;Me(o,"value",null),o.value=q}if(o.hasAttribute("checked")){var y=o.checked;Me(o,"checked",null),o.checked=y}}};o.__on_r=L,qe(L),Re()}}function Me(o,m,L,q){var y=at(o);we&&(y[m]=o.getAttribute(m),m==="src"||m==="srcset"||m==="href"&&o.nodeName==="LINK")||y[m]!==(y[m]=L)&&(m==="loading"&&(o[$e]=L),o.removeAttribute(m))}function at(o){return o.__attributes??={[tt]:o.nodeName.includes("-"),[rt]:o.namespaceURI===Ce}}function it(o,m,L=m){var q=We();Ge(o,"input",y=>{var j=y?o.defaultValue:o.value;if(j=ye(o)?ge(j):j,L(j),q&&j!==(j=m())){var R=o.selectionStart,l=o.selectionEnd;o.value=j??"",l!==null&&(o.selectionStart=R,o.selectionEnd=Math.min(l,o.value.length))}}),(we&&o.defaultValue!==o.value||Le(m)==null&&o.value)&&L(ye(o)?ge(o.value):o.value),Ue(()=>{var y=m();ye(o)&&y===ge(o.value)||o.type==="date"&&!y&&!o.value||y!==o.value&&(o.value=y??"")})}function ye(o){var m=o.type;return m==="number"||m==="range"}function ge(o){return o===""?null:+o}var pe={exports:{}},ke;function ft(){return ke||(ke=1,function(o,m){(function(L){function y(i){const e=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);let a=1779033703,d=3144134277,u=1013904242,v=2773480762,f=1359893119,b=2600822924,x=528734635,h=1541459225;const U=new Uint32Array(64);function M(C){let te=0,T=C.length;for(;T>=64;){let S=a,W=d,re=u,r=v,t=f,s=b,c=x,w=h,_,g,ne,K,ue;for(g=0;g<16;g++)ne=te+g*4,U[g]=(C[ne]&255)<<24|(C[ne+1]&255)<<16|(C[ne+2]&255)<<8|C[ne+3]&255;for(g=16;g<64;g++)_=U[g-2],K=(_>>>17|_<<15)^(_>>>19|_<<13)^_>>>10,_=U[g-15],ue=(_>>>7|_<<25)^(_>>>18|_<<14)^_>>>3,U[g]=(K+U[g-7]|0)+(ue+U[g-16]|0)|0;for(g=0;g<64;g++)K=(((t>>>6|t<<26)^(t>>>11|t<<21)^(t>>>25|t<<7))+(t&s^~t&c)|0)+(w+(e[g]+U[g]|0)|0)|0,ue=((S>>>2|S<<30)^(S>>>13|S<<19)^(S>>>22|S<<10))+(S&W^S&re^W&re)|0,w=c,c=s,s=t,t=r+K|0,r=re,re=W,W=S,S=K+ue|0;a=a+S|0,d=d+W|0,u=u+re|0,v=v+r|0,f=f+t|0,b=b+s|0,x=x+c|0,h=h+w|0,te+=64,T-=64}}M(i);let X,Q=i.length%64,$=i.length/536870912|0,P=i.length<<3,ee=Q<56?56:120,A=i.slice(i.length-Q,i.length);for(A.push(128),X=Q+1;X<ee;X++)A.push(0);return A.push($>>>24&255),A.push($>>>16&255),A.push($>>>8&255),A.push($>>>0&255),A.push(P>>>24&255),A.push(P>>>16&255),A.push(P>>>8&255),A.push(P>>>0&255),M(A),[a>>>24&255,a>>>16&255,a>>>8&255,a>>>0&255,d>>>24&255,d>>>16&255,d>>>8&255,d>>>0&255,u>>>24&255,u>>>16&255,u>>>8&255,u>>>0&255,v>>>24&255,v>>>16&255,v>>>8&255,v>>>0&255,f>>>24&255,f>>>16&255,f>>>8&255,f>>>0&255,b>>>24&255,b>>>16&255,b>>>8&255,b>>>0&255,x>>>24&255,x>>>16&255,x>>>8&255,x>>>0&255,h>>>24&255,h>>>16&255,h>>>8&255,h>>>0&255]}function j(i,e,a){i=i.length<=64?i:y(i);const d=64+e.length+4,u=new Array(d),v=new Array(64);let f,b=[];for(f=0;f<64;f++)u[f]=54;for(f=0;f<i.length;f++)u[f]^=i[f];for(f=0;f<e.length;f++)u[64+f]=e[f];for(f=d-4;f<d;f++)u[f]=0;for(f=0;f<64;f++)v[f]=92;for(f=0;f<i.length;f++)v[f]^=i[f];function x(){for(let h=d-1;h>=d-4;h--){if(u[h]++,u[h]<=255)return;u[h]=0}}for(;a>=32;)x(),b=b.concat(y(v.concat(y(u)))),a-=32;return a>0&&(x(),b=b.concat(y(v.concat(y(u))).slice(0,a))),b}function R(i,e,a,d,u){let v;for(p(i,(2*a-1)*16,u,0,16),v=0;v<2*a;v++)D(i,v*16,u,16),le(u,d),p(u,0,i,e+v*16,16);for(v=0;v<a;v++)p(i,e+v*2*16,i,v*16,16);for(v=0;v<a;v++)p(i,e+(v*2+1)*16,i,(v+a)*16,16)}function l(i,e){return i<<e|i>>>32-e}function le(i,e){p(i,0,e,0,16);for(let a=8;a>0;a-=2)e[4]^=l(e[0]+e[12],7),e[8]^=l(e[4]+e[0],9),e[12]^=l(e[8]+e[4],13),e[0]^=l(e[12]+e[8],18),e[9]^=l(e[5]+e[1],7),e[13]^=l(e[9]+e[5],9),e[1]^=l(e[13]+e[9],13),e[5]^=l(e[1]+e[13],18),e[14]^=l(e[10]+e[6],7),e[2]^=l(e[14]+e[10],9),e[6]^=l(e[2]+e[14],13),e[10]^=l(e[6]+e[2],18),e[3]^=l(e[15]+e[11],7),e[7]^=l(e[3]+e[15],9),e[11]^=l(e[7]+e[3],13),e[15]^=l(e[11]+e[7],18),e[1]^=l(e[0]+e[3],7),e[2]^=l(e[1]+e[0],9),e[3]^=l(e[2]+e[1],13),e[0]^=l(e[3]+e[2],18),e[6]^=l(e[5]+e[4],7),e[7]^=l(e[6]+e[5],9),e[4]^=l(e[7]+e[6],13),e[5]^=l(e[4]+e[7],18),e[11]^=l(e[10]+e[9],7),e[8]^=l(e[11]+e[10],9),e[9]^=l(e[8]+e[11],13),e[10]^=l(e[9]+e[8],18),e[12]^=l(e[15]+e[14],7),e[13]^=l(e[12]+e[15],9),e[14]^=l(e[13]+e[12],13),e[15]^=l(e[14]+e[13],18);for(let a=0;a<16;++a)i[a]+=e[a]}function D(i,e,a,d){for(let u=0;u<d;u++)a[u]^=i[e+u]}function p(i,e,a,d,u){for(;u--;)a[d++]=i[e++]}function J(i){if(!i||typeof i.length!="number")return!1;for(let e=0;e<i.length;e++){const a=i[e];if(typeof a!="number"||a%1||a<0||a>=256)return!1}return!0}function E(i,e){if(typeof i!="number"||i%1)throw new Error("invalid "+e);return i}function Y(i,e,a,d,u,v,f){if(a=E(a,"N"),d=E(d,"r"),u=E(u,"p"),v=E(v,"dkLen"),a===0||(a&a-1)!==0)throw new Error("N must be power of 2");if(a>2147483647/128/d)throw new Error("N too large");if(d>2147483647/128/u)throw new Error("r too large");if(!J(i))throw new Error("password must be an array or buffer");if(i=Array.prototype.slice.call(i),!J(e))throw new Error("salt must be an array or buffer");e=Array.prototype.slice.call(e);let b=j(i,e,u*128*d);const x=new Uint32Array(u*32*d);for(let t=0;t<x.length;t++){const s=t*4;x[t]=(b[s+3]&255)<<24|(b[s+2]&255)<<16|(b[s+1]&255)<<8|(b[s+0]&255)<<0}const h=new Uint32Array(64*d),U=new Uint32Array(32*d*a),M=32*d,X=new Uint32Array(16),Q=new Uint32Array(16),$=u*a*2;let P=0,ee=null,A=!1,C=0,te=0,T,S;const W=f?parseInt(1e3/d):4294967295,re=typeof setImmediate<"u"?setImmediate:setTimeout,r=function(){if(A)return f(new Error("cancelled"),P/$);let t;switch(C){case 0:S=te*32*d,p(x,S,h,0,M),C=1,T=0;case 1:t=a-T,t>W&&(t=W);for(let c=0;c<t;c++)p(h,0,U,(T+c)*M,M),R(h,M,d,X,Q);if(T+=t,P+=t,f){const c=parseInt(1e3*P/$);if(c!==ee){if(A=f(null,P/$),A)break;ee=c}}if(T<a)break;T=0,C=2;case 2:t=a-T,t>W&&(t=W);for(let c=0;c<t;c++){const w=(2*d-1)*16,_=h[w]&a-1;D(U,_*M,h,M),R(h,M,d,X,Q)}if(T+=t,P+=t,f){const c=parseInt(1e3*P/$);if(c!==ee){if(A=f(null,P/$),A)break;ee=c}}if(T<a)break;if(p(h,0,x,S,M),te++,te<u){C=0;break}b=[];for(let c=0;c<x.length;c++)b.push(x[c]>>0&255),b.push(x[c]>>8&255),b.push(x[c]>>16&255),b.push(x[c]>>24&255);const s=j(i,b,v);return f&&f(null,1,s),s}f&&re(r)};if(!f)for(;;){const t=r();if(t!=null)return t}r()}const ie={scrypt:function(i,e,a,d,u,v,f){return new Promise(function(b,x){let h=0;f&&f(0),Y(i,e,a,d,u,v,function(U,M,X){if(U)x(U);else if(X)f&&h!==1&&f(1),b(new Uint8Array(X));else if(f&&M!==h)return h=M,f(M)})})},syncScrypt:function(i,e,a,d,u,v){return new Uint8Array(Y(i,e,a,d,u,v))}};o.exports=ie})()}(pe)),pe.exports}var ot=ft();const st=et(ot);var ct=V('<div class="text-text-muted text-sm">Your connection is rather slow, peasant...</div>'),lt=V('<div class="text-text-muted text-sm">No musings found.</div>'),ut=V('<div class="rounded-sm border border-text-muted p-3 mb-4 bg-[color:var(--el-surface)]"><div class="flex items-center gap-2"><input type="password" class="px-2 py-1 rounded-sm bg-[color:var(--el-surface)] border border-text-muted text-xs flex-1 text-text placeholder:text-text transition-colors" placeholder="Key" id="global-passphrase"/> <button class="px-2 py-1 text-xs border border-accent-subtle rounded hover:bg-accent-subtle/20 disabled:opacity-50 text-text hover:text-accent transition-colors">Clear</button></div></div>'),dt=V('<button class="text-xs text-accent hover:text-accent/80 disabled:opacity-50"> </button>'),vt=V('<div class="break-all"> </div>'),ht=V('<div class="text-xs text-text-muted">Loading preview…</div>'),bt=V('<div class="text-xs text-accent mt-1"> </div>'),mt=V('<div class="mt-1"><!> <!></div>'),xt=V('<div class="mt-1"><article><!></article></div>'),_t=V('<div class="mt-1 text-xs text-text-muted">Loading…</div>'),yt=V('<li class="rounded-sm border border-text-muted bg-[color:var(--el-surface)] p-3"><div class="flex items-center justify-between gap-2"><div class="text-xs text-text-muted"> </div> <!></div> <!></li>'),gt=V('<div class="h-10"></div>'),pt=V('<!> <!> <ul class="list-none p-0 m-0 space-y-6"></ul> <!>',1);function Lt(o,m){Je(m,!1);const[L,q]=Qe(),y=()=>Ne(Ke,"$currentSkin",L),{scrypt:j}=st,R=new Ye({html:!0,linkify:!0,highlight:(r,t)=>{if(t&&Se.getLanguage(t))try{return`<pre class="hljs"><code>${Se.highlight(r,{language:t}).value}</code></pre>`}catch{}return`<pre class="hljs"><code>${R.utils.escapeHtml(r)}</code></pre>`}});let l=ae([]),le=ae(!1),D=ae({}),p=ae({}),J=ae(new Set),E=ae({}),Y=ae(""),ie=null;function i(){return ie||(ie=new Worker(new URL("/_astro/musingsWorker-CyUrPyvB.js",import.meta.url),{type:"module"})),ie}let e=ae({});const a={};function d(r){const t=r.split("");for(let s=t.length-1;s>0;s--){const c=Math.floor(Math.random()*(s+1));[t[s],t[c]]=[t[c],t[s]]}return t.join("")}function u(r){const t="decrypt";ce(e,n(e)[r]=t),a[r]=window.setInterval(()=>{ce(e,n(e)[r]=d(t)),H(e,{...n(e)})},80)}function v(r){a[r]&&(window.clearInterval(a[r]),delete a[r],delete n(e)[r])}function f(r){return new Date(r).toLocaleString()}function b(){if(typeof window<"u"){const r=window.MathJax;r?.typesetPromise&&r.typesetPromise()}}const x=12;let h=ae(x);function U(r,t){const s=new IntersectionObserver(c=>{for(const w of c)if(w.isIntersecting){try{t?.()}catch{}s.unobserve(r)}},{rootMargin:"400px 0px"});return s.observe(r),{destroy(){s.disconnect()}}}function M(r,t){let s=!1;const c=new IntersectionObserver(w=>{for(const _ of w)if(_.isIntersecting&&!s){s=!0,c.unobserve(r);try{t?.()}finally{requestAnimationFrame(()=>{setTimeout(()=>{s=!1,c.observe(r)},50)})}}},{rootMargin:"200px 0px"});return c.observe(r),{destroy(){c.disconnect()}}}function X(r){r.tier==="public"?n(p)[r.id]||Q(r).then(async t=>{const s=t;s&&s.md&&(ce(p,n(p)[r.id]={md:s.md}),H(p,{...n(p)}),await _e(),b())}):n(D)[r.id]||Q(r)}async function Q(r){if(n(D)[r.id])return n(D)[r.id];try{const t=await fetch(`/musings/${r.path}`);if(!t.ok)return null;const s=await t.json();return ce(D,n(D)[r.id]=s),H(D,{...n(D)}),s}catch{return null}}async function $(r,t){if(t.trim()){n(J).add(r),H(J,new Set(n(J))),delete n(E)[r],H(E,{...n(E)}),u(r),await _e();try{const s=n(l).find(w=>w.id===r);if(!s||s.tier==="public")return;const c=await Q(s);if(!c)throw new Error("Failed to load blob");await new Promise(w=>{const _=i(),g=ne=>{const K=ne.data;!K||K.id!==r||(_.removeEventListener("message",g),K.ok?(ce(p,n(p)[r]={md:K.md}),H(p,{...n(p)})):(ce(E,n(E)[r]=K.error||"Failed to decrypt"),H(E,{...n(E)})),w())};_.addEventListener("message",g),_.postMessage({id:r,blob:c,pass:t})}),await _e(),b()}catch(s){ce(E,n(E)[r]=s?.message??String(s)),H(E,{...n(E)})}finally{n(J).delete(r),H(J,new Set(n(J))),v(r)}}}Te(async()=>{try{const r=await fetch("/musings/manifest.json");r.ok&&(H(l,await r.json()),H(le,!0))}catch(r){console.error("Failed to load musings manifest:",r)}}),Oe(()=>{ie&&(ie.terminate(),ie=null)}),He();var P=pt(),ee=Xe(P);{var A=r=>{var t=ct();I(r,t)},C=(r,t)=>{{var s=c=>{var w=lt();I(c,w)};N(r,c=>{n(l).length===0&&c(s)},t)}};N(ee,r=>{n(le)?r(C,!1):r(A)})}var te=se(ee,2);{var T=r=>{var t=ut(),s=B(t),c=B(s);nt(c);var w=se(c,2);G(s),G(t),ve(()=>w.disabled=!n(Y)),it(c,()=>n(Y),_=>H(Y,_)),Ae("click",w,()=>H(Y,"")),I(r,t)};N(te,r=>{n(le)&&n(l).length>0&&r(T)})}var S=se(te,2);Be(S,5,()=>n(l).slice(0,n(h)),r=>r.id,(r,t)=>{var s=yt(),c=B(s),w=B(c),_=B(w,!0);G(w);var g=se(w,2);{var ne=O=>{var F=dt(),de=B(F,!0);G(F),ve((he,z)=>{F.disabled=he,be(de,z)},[()=>n(J).has(n(t).id)||!n(Y).trim(),()=>n(J).has(n(t).id)?n(e)[n(t).id]||"decrypting...":"decrypt"],xe),Ae("click",F,()=>$(n(t).id,n(Y))),I(O,F)};N(g,O=>{n(t).tier!=="public"&&!n(p)[n(t).id]&&O(ne)})}G(c);var K=se(c,2);{var ue=O=>{var F=mt(),de=B(F);{var he=k=>{var Z=vt(),me=B(Z);G(Z),ve(je=>be(me,`${je??""}${n(D)[n(t).id].ct.length>160?"…":""}`),[()=>n(D)[n(t).id].ct.slice(0,160)],xe),I(k,Z)},z=k=>{var Z=ht();I(k,Z)};N(de,k=>{n(D)[n(t).id]?k(he):k(z,!1)})}var fe=se(de,2);{var oe=k=>{var Z=bt(),me=B(Z,!0);G(Z),ve(()=>be(me,n(E)[n(t).id])),I(k,Z)};N(fe,k=>{n(E)[n(t).id]&&k(oe)})}G(F),I(O,F)},Pe=(O,F)=>{{var de=z=>{var fe=xt(),oe=B(fe),k=B(oe);ze(k,()=>R.render(n(p)[n(t).id].md)),G(oe),G(fe),ve(()=>De(oe,1,`${y().classes.contentPane??""} max-w-none`)),I(z,fe)},he=(z,fe)=>{{var oe=k=>{var Z=_t();I(k,Z)};N(z,k=>{n(t).tier==="public"&&k(oe)},fe)}};N(O,z=>{n(p)[n(t).id]?z(de):z(he,!1)},F)}};N(K,O=>{n(t).tier!=="public"&&!n(p)[n(t).id]?O(ue):O(Pe,!1)})}G(s),Ee(s,(O,F)=>U?.(O,F),()=>()=>X(n(t))),ve(O=>be(_,O),[()=>f(n(t).ts)],xe),I(r,s)}),G(S);var W=se(S,2);{var re=r=>{var t=gt();Ee(t,(s,c)=>M?.(s,c),()=>()=>H(h,Math.min(n(l).length,n(h)+x))),I(r,t)};N(W,r=>{n(le)&&n(h)<n(l).length&&r(re)})}I(o,P),Ze(),q()}export{Lt as default};

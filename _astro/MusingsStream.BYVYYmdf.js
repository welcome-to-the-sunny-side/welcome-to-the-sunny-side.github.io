import{o as Oe,e as He,i as De,d as Q,s as Ie,f as Ke}from"./router.qopiDDf4.js";import{S as Fe,T as ke,U as Ue,V as Ve,W as qe,h as we,X as Re,Y as $e,Z as Ce,_ as We,$ as Ge,a0 as Je,y as Xe,J as N,F as n,a1 as oe,D as R,Q as Ze,I as q,B as ze,E as K,N as ue,O as G,M as Z,G as ve,L as Ae,K as xe,a2 as _e}from"./template.Cu96Qf88.js";import{s as me}from"./render.C0qO3KmN.js";import{e as Be,s as Qe,h as Ne,a as Ye}from"./ContentPane.DnatqFR0.js";import et from"./index.Blr6EMNg.js";import{H as Se}from"./index.B4oS49FX.js";import{g as tt}from"./_commonjsHelpers.CqkleIqs.js";function Ee(s,_,U){Fe(()=>{var $=ke(()=>_(s,U?.())||{});if(U&&$?.update){var g=!1,T={};Ue(()=>{var P=U();Ve(P),g&&qe(T,P)&&(T=P,$.update(P))}),g=!0}if($?.destroy)return()=>$.destroy()})}const rt=Symbol("is custom element"),nt=Symbol("is html");function at(s){if(we){var _=!1,U=()=>{if(!_){if(_=!0,s.hasAttribute("value")){var $=s.value;Me(s,"value",null),s.value=$}if(s.hasAttribute("checked")){var g=s.checked;Me(s,"checked",null),s.checked=g}}};s.__on_r=U,Re(U),$e()}}function Me(s,_,U,$){var g=it(s);we&&(g[_]=s.getAttribute(_),_==="src"||_==="srcset"||_==="href"&&s.nodeName==="LINK")||g[_]!==(g[_]=U)&&(_==="loading"&&(s[Ce]=U),s.removeAttribute(_))}function it(s){return s.__attributes??={[rt]:s.nodeName.includes("-"),[nt]:s.namespaceURI===We}}function ft(s,_,U=_){var $=Ge();Je(s,"input",g=>{var T=g?s.defaultValue:s.value;if(T=ye(s)?ge(T):T,U(T),$&&T!==(T=_())){var P=s.selectionStart,d=s.selectionEnd;s.value=T??"",d!==null&&(s.selectionStart=P,s.selectionEnd=Math.min(d,s.value.length))}}),(we&&s.defaultValue!==s.value||ke(_)==null&&s.value)&&U(ye(s)?ge(s.value):s.value),Ue(()=>{var g=_();ye(s)&&g===ge(s.value)||s.type==="date"&&!g&&!s.value||g!==s.value&&(s.value=g??"")})}function ye(s){var _=s.type;return _==="number"||_==="range"}function ge(s){return s===""?null:+s}var pe={exports:{}},Le;function ot(){return Le||(Le=1,function(s,_){(function(U){function g(f){const e=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);let i=1779033703,c=3144134277,l=1013904242,u=2773480762,o=1359893119,m=2600822924,y=528734635,b=1541459225;const A=new Uint32Array(64);function S(C){let fe=0,j=C.length;for(;j>=64;){let E=i,D=c,te=l,re=u,t=o,r=m,a=y,v=b,h,x,z,ne,W;for(x=0;x<16;x++)z=fe+x*4,A[x]=(C[z]&255)<<24|(C[z+1]&255)<<16|(C[z+2]&255)<<8|C[z+3]&255;for(x=16;x<64;x++)h=A[x-2],ne=(h>>>17|h<<15)^(h>>>19|h<<13)^h>>>10,h=A[x-15],W=(h>>>7|h<<25)^(h>>>18|h<<14)^h>>>3,A[x]=(ne+A[x-7]|0)+(W+A[x-16]|0)|0;for(x=0;x<64;x++)ne=(((t>>>6|t<<26)^(t>>>11|t<<21)^(t>>>25|t<<7))+(t&r^~t&a)|0)+(v+(e[x]+A[x]|0)|0)|0,W=((E>>>2|E<<30)^(E>>>13|E<<19)^(E>>>22|E<<10))+(E&D^E&te^D&te)|0,v=a,a=r,r=t,t=re+ne|0,re=te,te=D,D=E,E=ne+W|0;i=i+E|0,c=c+D|0,l=l+te|0,u=u+re|0,o=o+t|0,m=m+r|0,y=y+a|0,b=b+v|0,fe+=64,j-=64}}S(f);let J,ie=f.length%64,O=f.length/536870912|0,H=f.length<<3,ee=ie<56?56:120,p=f.slice(f.length-ie,f.length);for(p.push(128),J=ie+1;J<ee;J++)p.push(0);return p.push(O>>>24&255),p.push(O>>>16&255),p.push(O>>>8&255),p.push(O>>>0&255),p.push(H>>>24&255),p.push(H>>>16&255),p.push(H>>>8&255),p.push(H>>>0&255),S(p),[i>>>24&255,i>>>16&255,i>>>8&255,i>>>0&255,c>>>24&255,c>>>16&255,c>>>8&255,c>>>0&255,l>>>24&255,l>>>16&255,l>>>8&255,l>>>0&255,u>>>24&255,u>>>16&255,u>>>8&255,u>>>0&255,o>>>24&255,o>>>16&255,o>>>8&255,o>>>0&255,m>>>24&255,m>>>16&255,m>>>8&255,m>>>0&255,y>>>24&255,y>>>16&255,y>>>8&255,y>>>0&255,b>>>24&255,b>>>16&255,b>>>8&255,b>>>0&255]}function T(f,e,i){f=f.length<=64?f:g(f);const c=64+e.length+4,l=new Array(c),u=new Array(64);let o,m=[];for(o=0;o<64;o++)l[o]=54;for(o=0;o<f.length;o++)l[o]^=f[o];for(o=0;o<e.length;o++)l[64+o]=e[o];for(o=c-4;o<c;o++)l[o]=0;for(o=0;o<64;o++)u[o]=92;for(o=0;o<f.length;o++)u[o]^=f[o];function y(){for(let b=c-1;b>=c-4;b--){if(l[b]++,l[b]<=255)return;l[b]=0}}for(;i>=32;)y(),m=m.concat(g(u.concat(g(l)))),i-=32;return i>0&&(y(),m=m.concat(g(u.concat(g(l))).slice(0,i))),m}function P(f,e,i,c,l){let u;for(w(f,(2*i-1)*16,l,0,16),u=0;u<2*i;u++)se(f,u*16,l,16),Y(l,c),w(l,0,f,e+u*16,16);for(u=0;u<i;u++)w(f,e+u*2*16,f,u*16,16);for(u=0;u<i;u++)w(f,e+(u*2+1)*16,f,(u+i)*16,16)}function d(f,e){return f<<e|f>>>32-e}function Y(f,e){w(f,0,e,0,16);for(let i=8;i>0;i-=2)e[4]^=d(e[0]+e[12],7),e[8]^=d(e[4]+e[0],9),e[12]^=d(e[8]+e[4],13),e[0]^=d(e[12]+e[8],18),e[9]^=d(e[5]+e[1],7),e[13]^=d(e[9]+e[5],9),e[1]^=d(e[13]+e[9],13),e[5]^=d(e[1]+e[13],18),e[14]^=d(e[10]+e[6],7),e[2]^=d(e[14]+e[10],9),e[6]^=d(e[2]+e[14],13),e[10]^=d(e[6]+e[2],18),e[3]^=d(e[15]+e[11],7),e[7]^=d(e[3]+e[15],9),e[11]^=d(e[7]+e[3],13),e[15]^=d(e[11]+e[7],18),e[1]^=d(e[0]+e[3],7),e[2]^=d(e[1]+e[0],9),e[3]^=d(e[2]+e[1],13),e[0]^=d(e[3]+e[2],18),e[6]^=d(e[5]+e[4],7),e[7]^=d(e[6]+e[5],9),e[4]^=d(e[7]+e[6],13),e[5]^=d(e[4]+e[7],18),e[11]^=d(e[10]+e[9],7),e[8]^=d(e[11]+e[10],9),e[9]^=d(e[8]+e[11],13),e[10]^=d(e[9]+e[8],18),e[12]^=d(e[15]+e[14],7),e[13]^=d(e[12]+e[15],9),e[14]^=d(e[13]+e[12],13),e[15]^=d(e[14]+e[13],18);for(let i=0;i<16;++i)f[i]+=e[i]}function se(f,e,i,c){for(let l=0;l<c;l++)i[l]^=f[e+l]}function w(f,e,i,c,l){for(;l--;)i[c++]=f[e++]}function M(f){if(!f||typeof f.length!="number")return!1;for(let e=0;e<f.length;e++){const i=f[e];if(typeof i!="number"||i%1||i<0||i>=256)return!1}return!0}function F(f,e){if(typeof f!="number"||f%1)throw new Error("invalid "+e);return f}function L(f,e,i,c,l,u,o){if(i=F(i,"N"),c=F(c,"r"),l=F(l,"p"),u=F(u,"dkLen"),i===0||(i&i-1)!==0)throw new Error("N must be power of 2");if(i>2147483647/128/c)throw new Error("N too large");if(c>2147483647/128/l)throw new Error("r too large");if(!M(f))throw new Error("password must be an array or buffer");if(f=Array.prototype.slice.call(f),!M(e))throw new Error("salt must be an array or buffer");e=Array.prototype.slice.call(e);let m=T(f,e,l*128*c);const y=new Uint32Array(l*32*c);for(let t=0;t<y.length;t++){const r=t*4;y[t]=(m[r+3]&255)<<24|(m[r+2]&255)<<16|(m[r+1]&255)<<8|(m[r+0]&255)<<0}const b=new Uint32Array(64*c),A=new Uint32Array(32*c*i),S=32*c,J=new Uint32Array(16),ie=new Uint32Array(16),O=l*i*2;let H=0,ee=null,p=!1,C=0,fe=0,j,E;const D=o?parseInt(1e3/c):4294967295,te=typeof setImmediate<"u"?setImmediate:setTimeout,re=function(){if(p)return o(new Error("cancelled"),H/O);let t;switch(C){case 0:E=fe*32*c,w(y,E,b,0,S),C=1,j=0;case 1:t=i-j,t>D&&(t=D);for(let a=0;a<t;a++)w(b,0,A,(j+a)*S,S),P(b,S,c,J,ie);if(j+=t,H+=t,o){const a=parseInt(1e3*H/O);if(a!==ee){if(p=o(null,H/O),p)break;ee=a}}if(j<i)break;j=0,C=2;case 2:t=i-j,t>D&&(t=D);for(let a=0;a<t;a++){const v=(2*c-1)*16,h=b[v]&i-1;se(A,h*S,b,S),P(b,S,c,J,ie)}if(j+=t,H+=t,o){const a=parseInt(1e3*H/O);if(a!==ee){if(p=o(null,H/O),p)break;ee=a}}if(j<i)break;if(w(b,0,y,E,S),fe++,fe<l){C=0;break}m=[];for(let a=0;a<y.length;a++)m.push(y[a]>>0&255),m.push(y[a]>>8&255),m.push(y[a]>>16&255),m.push(y[a]>>24&255);const r=T(f,m,u);return o&&o(null,1,r),r}o&&te(re)};if(!o)for(;;){const t=re();if(t!=null)return t}re()}const ae={scrypt:function(f,e,i,c,l,u,o){return new Promise(function(m,y){let b=0;o&&o(0),L(f,e,i,c,l,u,function(A,S,J){if(A)y(A);else if(J)o&&b!==1&&o(1),m(new Uint8Array(J));else if(o&&S!==b)return b=S,o(S)})})},syncScrypt:function(f,e,i,c,l,u){return new Uint8Array(L(f,e,i,c,l,u))}};s.exports=ae})()}(pe)),pe.exports}var st=ot();const ct=tt(st);var lt=R('<div class="text-text-muted text-sm">Your connection is rather slow, peasant...</div>'),ut=R('<div class="text-text-muted text-sm">No musings found.</div>'),dt=R('<div class="rounded-sm border border-text-muted p-3 mb-4 bg-[color:var(--el-surface)]"><div class="flex items-center gap-2"><input type="password" class="px-2 py-1 rounded-sm bg-[color:var(--el-surface)] border border-text-muted text-xs flex-1 text-text placeholder:text-text transition-colors" placeholder="Key" id="global-passphrase"/> <button class="px-2 py-1 text-xs border border-accent-subtle rounded hover:bg-accent-subtle/20 disabled:opacity-50 text-text hover:text-accent transition-colors">Clear</button></div></div>'),vt=R('<button class="text-xs text-accent hover:text-accent/80 disabled:opacity-50"> </button>'),ht=R('<div class="break-all"> </div>'),mt=R('<div class="text-xs text-text-muted">Loading preview…</div>'),bt=R('<div class="text-xs text-accent mt-1"> </div>'),xt=R('<div class="mt-1"><!> <!></div>'),_t=R('<div class="mt-1"><article><!></article></div>'),yt=R('<div class="mt-1 text-xs text-text-muted">Loading…</div>'),gt=R('<li class="rounded-sm border border-text-muted bg-[color:var(--el-surface)] p-3"><div class="flex items-center justify-between gap-2"><div class="text-xs text-text-muted"> </div> <!></div> <!></li>'),pt=R('<div class="h-10"></div>'),wt=R('<!> <!> <ul class="list-none p-0 m-0 space-y-6"></ul> <!>',1);function Pt(s,_){Xe(_,!1);const[U,$]=Qe(),g=()=>Ye(Ke,"$currentSkin",U),{scrypt:T}=ct,P=N(new et({html:!0,linkify:!0,highlight:(t,r)=>{if(r&&Se.getLanguage(r))try{return`<pre class="hljs"><code>${Se.highlight(t,{language:r}).value}</code></pre>`}catch{}return`<pre class="hljs"><code>${n(P).utils.escapeHtml(t)}</code></pre>`}})),d=n(P).renderer.rules.image||((t,r,a,v,h)=>h.renderToken(t,r,a));oe(P,n(P).renderer.rules.image=(t,r,a,v,h)=>(t[r].attrSet("loading","lazy"),t[r].attrSet("decoding","async"),d(t,r,a,v,h)));let Y=N([]),se=N(!1),w=N({}),M=N({}),F=N(new Set),L=N({}),ae=N(""),f=null;function e(){return f||(f=new Worker(new URL("/_astro/musingsWorker-CyUrPyvB.js",import.meta.url),{type:"module"})),f}let i=N({});const c={};function l(t){const r=t.split("");for(let a=r.length-1;a>0;a--){const v=Math.floor(Math.random()*(a+1));[r[a],r[v]]=[r[v],r[a]]}return r.join("")}function u(t){const r="decrypt";oe(i,n(i)[t]=r),c[t]=window.setInterval(()=>{oe(i,n(i)[t]=l(r)),K(i,{...n(i)})},80)}function o(t){c[t]&&(window.clearInterval(c[t]),delete c[t],delete n(i)[t])}function m(t){return new Date(t).toLocaleString()}function y(){if(typeof window<"u"){const t=window.MathJax;t?.typesetPromise&&t.typesetPromise()}}const b=12;let A=N(b);function S(t,r){const a=new IntersectionObserver(v=>{for(const h of v)if(h.isIntersecting){try{r?.()}catch{}a.unobserve(t)}},{rootMargin:"400px 0px"});return a.observe(t),{destroy(){a.disconnect()}}}function J(t,r){let a=!1;const v=new IntersectionObserver(h=>{for(const x of h)if(x.isIntersecting&&!a){a=!0,v.unobserve(t);try{r?.()}finally{requestAnimationFrame(()=>{setTimeout(()=>{a=!1,v.observe(t)},50)})}}},{rootMargin:"200px 0px"});return v.observe(t),{destroy(){v.disconnect()}}}function ie(t){t.tier==="public"?n(M)[t.id]||O(t).then(async r=>{const a=r;a&&a.md&&(oe(M,n(M)[t.id]={md:a.md}),K(M,{...n(M)}),await _e(),y())}):n(w)[t.id]||O(t)}async function O(t){if(n(w)[t.id])return n(w)[t.id];try{const r=await fetch(`/musings/${t.path}`);if(!r.ok)return null;const a=await r.json();return oe(w,n(w)[t.id]=a),K(w,{...n(w)}),a}catch{return null}}async function H(t,r){if(r.trim()){n(F).add(t),K(F,new Set(n(F))),delete n(L)[t],K(L,{...n(L)}),u(t),await _e();try{const a=n(Y).find(h=>h.id===t);if(!a||a.tier==="public")return;const v=await O(a);if(!v)throw new Error("Failed to load blob");await new Promise(h=>{const x=e(),z=ne=>{const W=ne.data;!W||W.id!==t||(x.removeEventListener("message",z),W.ok?(oe(M,n(M)[t]={md:W.md}),K(M,{...n(M)})):(oe(L,n(L)[t]=W.error||"Failed to decrypt"),K(L,{...n(L)})),h())};x.addEventListener("message",z),x.postMessage({id:t,blob:v,pass:r})}),await _e(),y()}catch(a){oe(L,n(L)[t]=a?.message??String(a)),K(L,{...n(L)})}finally{n(F).delete(t),K(F,new Set(n(F))),o(t)}}}Oe(async()=>{try{const t=await fetch("/musings/manifest.json");t.ok&&(K(Y,await t.json()),K(se,!0))}catch(t){console.error("Failed to load musings manifest:",t)}}),He(()=>{f&&(f.terminate(),f=null)}),De();var ee=wt(),p=Ze(ee);{var C=t=>{var r=lt();q(t,r)},fe=(t,r)=>{{var a=v=>{var h=ut();q(v,h)};Q(t,v=>{n(Y).length===0&&v(a)},r)}};Q(p,t=>{n(se)?t(fe,!1):t(C)})}var j=ue(p,2);{var E=t=>{var r=dt(),a=Z(r),v=Z(a);at(v);var h=ue(v,2);G(a),G(r),ve(()=>h.disabled=!n(ae)),ft(v,()=>n(ae),x=>K(ae,x)),Ae("click",h,()=>K(ae,"")),q(t,r)};Q(j,t=>{n(se)&&n(Y).length>0&&t(E)})}var D=ue(j,2);Be(D,5,()=>n(Y).slice(0,n(A)),t=>t.id,(t,r)=>{var a=gt(),v=Z(a),h=Z(v),x=Z(h,!0);G(h);var z=ue(h,2);{var ne=I=>{var V=vt(),de=Z(V,!0);G(V),ve((he,B)=>{V.disabled=he,me(de,B)},[()=>n(F).has(n(r).id)||!n(ae).trim(),()=>n(F).has(n(r).id)?n(i)[n(r).id]||"decrypting...":"decrypt"],xe),Ae("click",V,()=>H(n(r).id,n(ae))),q(I,V)};Q(z,I=>{n(r).tier!=="public"&&!n(M)[n(r).id]&&I(ne)})}G(v);var W=ue(v,2);{var Pe=I=>{var V=xt(),de=Z(V);{var he=k=>{var X=ht(),be=Z(X);G(X),ve(Te=>me(be,`${Te??""}${n(w)[n(r).id].ct.length>160?"…":""}`),[()=>n(w)[n(r).id].ct.slice(0,160)],xe),q(k,X)},B=k=>{var X=mt();q(k,X)};Q(de,k=>{n(w)[n(r).id]?k(he):k(B,!1)})}var ce=ue(de,2);{var le=k=>{var X=bt(),be=Z(X,!0);G(X),ve(()=>me(be,n(L)[n(r).id])),q(k,X)};Q(ce,k=>{n(L)[n(r).id]&&k(le)})}G(V),q(I,V)},je=(I,V)=>{{var de=B=>{var ce=_t(),le=Z(ce),k=Z(le);Ne(k,()=>n(P).render(n(M)[n(r).id].md)),G(le),G(ce),ve(()=>Ie(le,1,`${g().classes.contentPane??""} max-w-none`)),q(B,ce)},he=(B,ce)=>{{var le=k=>{var X=yt();q(k,X)};Q(B,k=>{n(r).tier==="public"&&k(le)},ce)}};Q(I,B=>{n(M)[n(r).id]?B(de):B(he,!1)},V)}};Q(W,I=>{n(r).tier!=="public"&&!n(M)[n(r).id]?I(Pe):I(je,!1)})}G(a),Ee(a,(I,V)=>S?.(I,V),()=>()=>ie(n(r))),ve(I=>me(x,I),[()=>m(n(r).ts)],xe),q(t,a)}),G(D);var te=ue(D,2);{var re=t=>{var r=pt();Ee(r,(a,v)=>J?.(a,v),()=>()=>K(A,Math.min(n(Y).length,n(A)+b))),q(t,r)};Q(te,t=>{n(se)&&n(A)<n(Y).length&&t(re)})}q(s,ee),ze(),$()}export{Pt as default};
